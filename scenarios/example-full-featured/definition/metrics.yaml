extraction_model: "openai/gpt-4o-mini"

metrics:
  # Pattern-based metrics (simple regex matching)
  - name: "budget_spent"
    description: "Total budget committed or spent (in millions)"
    extraction_type: "pattern"
    pattern: '\$(\d+(?:\.\d+)?)\s*(?:M|million)'
    data_type: "float"
    aggregation: "max"  # Track highest mentioned amount

  - name: "ai_systems_deployed"
    description: "Number of AI systems actually deployed"
    extraction_type: "pattern"
    pattern: '(\d+)\s+(?:AI\s+)?systems?\s+(?:deployed|implemented|launched)'
    data_type: "integer"
    aggregation: "max"

  # Keyword-based metrics (count occurrences)
  - name: "privacy_concerns_mentioned"
    description: "Frequency of privacy/surveillance concerns"
    extraction_type: "keyword"
    keywords:
      - "privacy"
      - "surveillance"
      - "civil liberties"
      - "data protection"
    data_type: "integer"
    aggregation: "sum"

  - name: "public_opposition_indicators"
    description: "Signs of public resistance or opposition"
    extraction_type: "keyword"
    keywords:
      - "protest"
      - "opposition"
      - "backlash"
      - "lawsuit"
      - "petition"
    data_type: "integer"
    aggregation: "sum"

  # LLM-based metrics (AI extraction for complex concepts)
  - name: "public_support_level"
    description: "Overall public support for AI initiatives (0-10 scale)"
    extraction_type: "llm"
    extraction_prompt: |
      Based on the world state, rate the overall public support level for the city's
      AI initiatives on a scale from 0-10, where:
      - 0 = Strong opposition, protests, major backlash
      - 5 = Mixed/neutral, some support and some opposition
      - 10 = Enthusiastic support, broad acceptance

      Consider: surveys, public comments, media coverage, organized opposition/support.

      Respond with ONLY a number between 0-10.
    data_type: "integer"
    aggregation: "last"  # Most recent value is most relevant

  - name: "implementation_quality"
    description: "Quality of AI system implementation (0-10 scale)"
    extraction_type: "llm"
    extraction_prompt: |
      Based on the world state, rate the quality of AI system implementation on a scale from 0-10:
      - 0 = Seriously flawed, major problems
      - 5 = Adequate but with issues
      - 10 = Excellent implementation with strong safeguards

      Consider: technical quality, oversight mechanisms, transparency, handling of concerns.

      If no systems deployed yet, respond with: null
      Otherwise respond with ONLY a number between 0-10.
    data_type: "integer"
    aggregation: "last"

  - name: "stakeholder_consensus"
    description: "Level of consensus among key stakeholders (0-10 scale)"
    extraction_type: "llm"
    extraction_prompt: |
      Rate the level of consensus among major stakeholders (mayor, tech company,
      privacy advocates, citizens) on a scale from 0-10:
      - 0 = Deep conflict, no agreement
      - 5 = Some compromise, partial agreement
      - 10 = Strong consensus, aligned goals

      Consider: whether stakeholders are working together or in opposition.

      Respond with ONLY a number between 0-10.
    data_type: "integer"
    aggregation: "last"

thresholds:
  budget_spent:
    warning: 8.0  # Warn if approaching budget limit
    critical: 10.0  # Critical if exceeding budget

  public_support_level:
    warning: 4  # Warn if support drops below moderate
    critical: 2  # Critical if strong opposition

  implementation_quality:
    warning: 4  # Warn if quality is subpar
    critical: 2  # Critical if seriously flawed
